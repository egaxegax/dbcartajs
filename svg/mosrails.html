<!DOCTYPE html>
<!--
Moscow Rail Roads map. SVG version.
View lines and stations with additional info.
egax@bk.ru, 2015-22.
-->
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Схема ж/д Москвы и МО в 2015 году / SVG векторная карта</title>
<meta name="description" content="Карта железных дорог Москвы и МО. Схема пригородного жд сообщения Москвы и МО в 2015 году.">
<meta name="keywords" content="Схема электричек, Карта железных дорог Москвы и МО, Схема пригородного ж/д транспорта Москвы и МО. Moscow Underground and Commuter Rail Map">
<link rel="icon" href="../img/fav.svg" type="image/svg+xml">
<link rel="canonical" href="mosrails.html">
<style>html,body,table{overflow:hidden;border-collapse:collapse;margin:0;padding:0;width:100%;height:100%}</style>
<script defer src="/static/js/metrics.js" data-floor="1"></script>
</head>
<body>
<script src="../js/data/mosrails.js"></script>
<script src="../js/dbcartasvg.js"></script>
<table><tr><td id="mcont" style="position:relative">
  <div id="yandex_rtb_R-A-2277013-2" style="max-height:90px; position:fixed"></div>
</td></tr></table>
<script>
  // diagonal size
function mds(o) { 
  return Math.sqrt(DC.sizeOf()[2]*DC.sizeOf()[2]+DC.sizeOf()[3]*DC.sizeOf()[3])/15*o/100;
}
function draw() {
  var mopt = {};
  function route(o)  { return DC.extend({width: 6, anchor: ['start', 'middle'], labelscale: 1}, o||{}) };
  function route_d(o){ return route(DC.extend({width: 1, fg: 'white', dash: [4,2]}, o||{})) };
  function inch(o)   { return route(DC.extend({fg: 'black', join: 'round', cap: 'round', width: 6}, o||{})) };
  function inch_d(o) { return inch(DC.extend({fg: 'white', width: 5}, o||{})) };
  function label(o)  { return DC.extend({labelscale: 1, labelcolor: '#a5a6aa'}, o||{}) };
  function station(o){ return DC.extend({bg: 'white', size: 4, width: 3, scale: 1, labelscale: 1}, o||{}) };
  function inst(o)   { return station(DC.extend({fg: '#a5a6aa', labelcolor: o['labelcolor']}, o)) };
  function inst_l(o) { return inst(DC.extend({bg: o['labelcolor'], fg: o['labelcolor']}, o)) };
  function rst(o)    { return station(DC.extend({size: 6, width: 4, join: 'round', labelcolor: 'black'}, o)) };
  function rst_d(o)  { return rst(DC.extend({size: 3}, o)) };
  function rst_l(o)  { return rst(DC.extend({labelcolor: o['fg']}, o)) };
  function ost(o)    { return rst(DC.extend({size: 3, width: 1}, o)) };
   // lines
  DC.extend(mopt, {
   // metro
    r:      route({fg: '#a5a6aa'}),
    r1:     route({fg: '#f92b40'}),
    r2:     route({fg: '#3e8249'}),
    r3:     route({fg: '#0055ac'}),
    r4:     route({fg: '#0293e4'}),
    r5:     route({fg: '#904736'}),
    r6:     route({fg: '#f37e17'}),
    r7:     route({fg: '#8b539e'}),
    r8:     route({fg: '#fcc932'}),
    r9:     route({fg: '#838287'}),
    r10:    route({fg: '#9ec167'}),
    r11:    route({fg: '#81cec8'}),
    r12:    route({fg: '#000000'}),
   // rails
    t1:     route({fg: '#f6422b'}),
    t2:     route({fg: '#005a96'}),
    t3:     route({fg: '#8fc442'}),
    t4:     route({fg: '#29c0d3'}),
    t5:     route({fg: '#9f678e'}),
    t6:     route({fg: '#702c8f'}),
    t7:     route({fg: '#f8733b'}),
    t8:     route({fg: '#1b8cce'}),
    t9:     route({fg: '#fdcd45'}),
    t10:    route({fg: '#14a256'}),
    t11:    route({fg: '#eb479d'}),
    mono:   route({fg: '#2c87c5', width: 2, labelcolor: '#2c87c5', anchor: ['start', 'bottom']}),
   // roads
    mkad:   route({bg: 'white', fg: 'rgb(210,230,250)', width: 1, labelcolor: 'rgb(180,180,180)', anchor: ['center', 'middle']}),
   // label
    e1:     label({anchor: ['end', 'middle']}),
    e2:     label({anchor: ['start', 'middle']}),
   // aero 
    t2_d:   route_d(),
    t3_d:   route_d(),
    t7_d:   route_d(),
   // interchanges
    inch:   inch(),
    inch_d: inch_d(),
    inch_dl:inch_d({dash: [1,5]})
  });
   // metro stations
  DC.extend(mopt, {
    s1:     inst_l({labelcolor: mopt['r1'].fg, anchor: ['center','bottom']}),
    s1_1:   inst({  labelcolor: mopt['r1'].fg, anchor: ['start', 'top']}),
    s1_2:   inst({  labelcolor: mopt['r1'].fg, anchor: ['start', 'top']}),
    s1_3:   inst({  labelcolor: mopt['r1'].fg, anchor: ['end']}),
    s1_4:   inst_l({labelcolor: mopt['r1'].fg, anchor: ['center','top']}),
    s2:     inst_l({labelcolor: mopt['r2'].fg, anchor: ['end',   'middle']}),
    s2_1:   inst({  labelcolor: mopt['r2'].fg, anchor: ['end',   'middle']}),
    s2_2:   inst({  labelcolor: mopt['r2'].fg}),
    s2_3:   inst({  labelcolor: mopt['r2'].fg,  anchor: ['center','top']}),
    s2_4:   inst_l({labelcolor: mopt['r2'].fg,  anchor: ['end',   'top']}),
    s3:     inst_l({labelcolor: mopt['r3'].fg,  anchor: ['start', 'middle']}),
    s3_1:   inst({  labelcolor: mopt['r3'].fg,  anchor: ['start', 'middle']}),
    s3_2:   inst({  labelcolor: mopt['r3'].fg,  anchor: ['end',   'top']}),
    s3_3:   inst({  labelcolor: mopt['r3'].fg,  anchor: ['end',   'middle']}),
    s3_4:   inst({  labelcolor: mopt['r3'].fg,  anchor: ['start', 'top']}),
    s4:     inst_l({labelcolor: mopt['r4'].fg,  anchor: ['start', 'bottom']}),
    s4_1:   inst({  labelcolor: mopt['r4'].fg}),
    s4_2:   inst({  labelcolor: mopt['r4'].fg,  anchor: ['end',   'bottom']}),
    s5:     inst({  labelcolor: mopt['r5'].fg}),
    s5_1:   inst({  labelcolor: mopt['r5'].fg,  anchor: ['end']}),
    s5_2:   inst({  labelcolor: mopt['r5'].fg,  anchor: ['start', 'top']}),
    s5_3:   inst({  labelcolor: mopt['r5'].fg,  anchor: ['start', 'bottom']}),
    s5_4:   inst({  labelcolor: mopt['r5'].fg,  anchor: ['end',   'middle']}),
    s5_5:   inst({  labelcolor: mopt['r5'].fg,  anchor: ['end',   'top']}),
    s6:     inst_l({labelcolor: mopt['r6'].fg,  anchor: ['center','bottom']}),
    s6_1:   inst({  labelcolor: mopt['r6'].fg}),
    s6_2:   inst({  labelcolor: mopt['r6'].fg,  anchor: ['end']}),
    s6_3:   inst({  labelcolor: mopt['r6'].fg,  anchor: ['center','top']}),
    s6_4:   inst_l({labelcolor: mopt['r6'].fg,  anchor: ['center','top']}),
    s6_5:   inst({  labelcolor: mopt['r6'].fg,  anchor: ['start', 'middle']}),
    s6_6:   inst({  labelcolor: mopt['r6'].fg,  anchor: ['end',   'bottom']}),
    s7:     inst_l({labelcolor: mopt['r7'].fg}),
    s7_1:   inst({  labelcolor: mopt['r7'].fg,  anchor: ['end',   'middle']}),
    s7_2:   inst({  labelcolor: mopt['r7'].fg,  anchor: ['start', 'middle']}),
    s7_3:   inst({  labelcolor: mopt['r7'].fg,  anchor: ['center','top']}),
    s7_4:   inst_l({labelcolor: mopt['r7'].fg,  anchor: ['end',   'top']}),
    s7_5:   inst({  labelcolor: mopt['r7'].fg,  anchor: ['end',   'bottom']}),
    s7_6:   inst({  labelcolor: mopt['r7'].fg,  anchor: ['end',   'top']}),
    s8:     inst_l({labelcolor: mopt['r8'].fg,  anchor: ['center','bottom']}),
    s8_1:   inst({  labelcolor: mopt['r8'].fg,  anchor: ['start', 'bottom']}),
    s8_2:   inst({  labelcolor: mopt['r8'].fg,  anchor: ['center','top']}),
    s8_3:   inst({  labelcolor: mopt['r8'].fg,  anchor: ['start', 'middle']}),
    s8_4:   inst({  labelcolor: mopt['r8'].fg,  anchor: ['end',   'bottom']}),
    s9:     inst_l({labelcolor: mopt['r9'].fg,  anchor: ['center','bottom']}),
    s9_1:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['start', 'middle']}),
    s9_2:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['center','bottom']}),
    s9_3:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['end',   'middle']}),
    s9_4:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['center','top']}),
    s9_5:   inst_l({labelcolor: mopt['r9'].fg,  anchor: ['end',   'middle']}),
    s9_6:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['start', 'bottom']}),
    s9_7:   inst({  labelcolor: mopt['r9'].fg,  anchor: ['start', 'top']}),
    s10:    inst_l({labelcolor: mopt['r10'].fg, anchor: ['end',   'middle']}),
    s10_1:  inst({  labelcolor: mopt['r10'].fg}),
    s10_2:  inst({  labelcolor: mopt['r10'].fg, anchor: ['center','bottom']}),
    s10_3:  inst({  labelcolor: mopt['r10'].fg, anchor: ['end',   'top']}),
    s10_4:  inst_l({labelcolor: mopt['r10'].fg}),
    s11_1:  inst({  labelcolor: mopt['r11'].fg, anchor: ['start', 'bottom']}),
    s11_2:  inst({  labelcolor: mopt['r11'].fg, anchor: ['center','bottom']}),
    s12_1:  inst({  labelcolor: mopt['r12'].fg}),
    s12_2:  inst({  labelcolor: mopt['r12'].fg, anchor: ['end',   'top']}),
    s13:    station({fg: mopt['mono'].fg, width: 2, anchor: ['end',   'bottom']}),
    s13_1:  station({fg: mopt['mono'].fg, width: 2, anchor: ['center','bottom']}),
    s13_2:  station({fg: mopt['mono'].fg, width: 2, anchor: ['start', 'bottom']}),
    s13_3:  station({fg: mopt['mono'].fg, width: 2, anchor: ['end',   'top']}),
    s13_4:  station({fg: mopt['mono'].fg, width: 2, anchor: ['start', 'middle']})
  });
   // rail stations
  DC.extend(mopt, {
    b1:     rst({fg: mopt['r'].fg, anchor: ['center', 'top']}),
    a1:     rst({fg: mopt['t1'].fg, anchor: ['end', 'middle']}),
    a1_1:   rst({fg: mopt['t1'].fg, anchor: ['center', 'bottom']}),
    a1_2:   rst({fg: mopt['t1'].fg, anchor: ['center', 'top']}),
    a1_3:   rst({fg: mopt['t1'].fg}),
    a1_4:   rst({fg: mopt['t1'].fg, anchor: ['start', 'bottom']}),
    a1_5:   ost({anchor: ['end', 'middle']}),
    a1_6:   ost({anchor: ['start', 'middle']}),
    a2:     rst({fg: mopt['t2'].fg, anchor: ['end', 'bottom']}),
    a2_1:   rst({fg: mopt['t2'].fg, anchor: ['end', 'middle']}),
    a2_2:   rst_l({fg: mopt['t2'].fg, anchor: ['start', 'middle']}),
    a2_3:   rst({fg: mopt['t2'].fg, anchor: ['start', 'middle']}),
    a2_4:   rst({fg: mopt['t2'].fg, anchor: ['end', 'top']}),
    a2_5:   ost({anchor: ['start', 'middle']}),
    a2_6:   ost({anchor: ['end', 'middle']}),
    a3:     rst({fg: mopt['t3'].fg, anchor: ['end', 'middle']}),
    a3_1:   rst({fg: mopt['t3'].fg, anchor: ['start', 'middle']}),
    a3_2:   rst({fg: mopt['t3'].fg, anchor: ['center', 'bottom']}),
    a3_3:   rst_l({fg: mopt['t3'].fg, anchor: ['start', 'middle']}),
    a3_4:   ost({anchor: ['end', 'middle']}),
    a3_5:   ost({anchor: ['start', 'middle']}),
    a4:     rst({fg: mopt['t4'].fg, anchor: ['end', 'middle']}),
    a4_1:   rst({fg: mopt['t4'].fg, anchor: ['end', 'top']}),
    a4_2:   rst({fg: mopt['t4'].fg, anchor: ['center', 'bottom']}),
    a4_3:   rst({fg: mopt['t4'].fg}),
    a4_4:   rst({fg: mopt['t4'].fg}),
    a4_5:   rst({fg: mopt['t4'].fg, anchor: ['end', 'bottom']}),
    a4_6:   rst({fg: mopt['t4'].fg, anchor: ['start', 'top']}),
    a4_7:   ost({anchor: ['end', 'middle']}),
    a4_8:   ost({anchor: ['start', 'middle']}),
    a5:     rst({fg: mopt['t5'].fg, anchor: ['end', 'bottom']}),
    a5_0:   rst({fg: mopt['t5'].fg, anchor: ['end', 'middle']}),
    a5_1:   rst({fg: mopt['t5'].fg, anchor: ['center', 'bottom']}),
    a5_2:   rst({fg: mopt['t5'].fg, anchor: ['start', 'bottom']}),
    a5_3:   rst({fg: mopt['t5'].fg, anchor: ['end', 'top']}),
    a5_4:   ost({anchor: ['end', 'middle']}),
    a5_5:   ost({anchor: ['start', 'middle']}),
    a5_6:   ost({anchor: ['center', 'bottom']}),
    a5_7:   ost({anchor: ['center', 'top']}),
    a6:     rst({fg: mopt['t6'].fg, anchor: ['start', 'middle']}),
    a6_1:   rst({fg: mopt['t6'].fg, anchor: ['center', 'bottom']}),
    a6_2:   rst({fg: mopt['t6'].fg, anchor: ['start', 'middle']}),
    a6_3:   rst({fg: mopt['t6'].fg, anchor: ['end', 'top']}),
    a6_4:   ost({anchor: ['end', 'middle']}),
    a6_5:   ost({anchor: ['start', 'middle']}),
    a6_6:   ost({anchor: ['center', 'bottom']}),
    a6_7:   ost({anchor: ['center', 'top']}),
    a7:     rst({fg: mopt['t7'].fg, anchor: ['end', 'middle']}),
    a7_0:   rst({fg: mopt['t7'].fg, anchor: ['end', 'top']}),
    a7_1:   rst({fg: mopt['t7'].fg, anchor: ['start', 'middle']}),
    a7_2:   rst_l({fg: mopt['t7'].fg, anchor: ['end', 'top']}),
    a7_3:   ost({anchor: ['end', 'middle']}),
    a7_4:   ost({anchor: ['end', 'top']}),
    a7_5:   ost({anchor: ['start', 'middle']}),
    a7_6:   ost({anchor: ['end', 'middle']}),
    a8:     rst({fg: mopt['t8'].fg, anchor: ['start', 'bottom']}),
    a8_2:   rst({fg: mopt['t8'].fg, anchor: ['end', 'middle']}),
    a8_3:   rst({fg: mopt['t8'].fg, anchor: ['start', 'middle']}),
    a8_4:   rst({fg: mopt['t8'].fg, anchor: ['center', 'bottom']}),
    a8_5:   rst({fg: mopt['t8'].fg, anchor: ['start', 'top']}),
    a8_6:   ost({anchor: ['end', 'middle']}),
    a8_7:   ost({anchor: ['start', 'middle']}),
    a9:     rst({fg: mopt['t9'].fg, anchor: ['end', 'middle']}),
    a9_1:   rst({fg: mopt['t9'].fg, anchor: ['end', 'top']}),
    a9_2:   rst({fg: mopt['t9'].fg, anchor: ['start', 'middle']}),
    a9_3:   rst({fg: mopt['t9'].fg, anchor: ['start', 'top']}),
    a9_4:   rst({fg: mopt['t9'].fg, anchor: ['center', 'top']}),
    a9_5:   rst({fg: mopt['t9'].fg, anchor: ['center', 'bottom']}),
    a9_6:   rst({fg: mopt['t9'].fg, anchor: ['start', 'middle']}),
    a9_7:   ost({anchor: ['end', 'middle']}),
    a9_8:   ost({anchor: ['start', 'middle']}),
    a9_9:   ost({anchor: ['center', 'bottom']}),
    a9_10:  rst_d({fg: mopt['t9'].fg}),
    a10:    rst({fg: mopt['t10'].fg, anchor: ['end', 'top']}),
    a10_1:  rst({fg: mopt['t10'].fg, anchor: ['start', 'top']}),
    a10_2:  rst({fg: mopt['t10'].fg, anchor: ['start', 'middle']}),
    a10_3:  rst({fg: mopt['t10'].fg, anchor: ['end', 'middle']}),
    a10_4:  ost({anchor: ['start', 'middle']}),
    a10_5:  ost({anchor: ['end', 'middle']}),
    a10_6:  ost({anchor: ['center', 'top']}),
    a10_7:  ost({anchor: ['center', 'bottom']}),
    a10_8:  ost({anchor: ['end', 'bottom']}),
    a11:    rst({fg: mopt['t11'].fg, anchor: ['center', 'top']}),
    a11_1:  rst({fg: mopt['t11'].fg, anchor: ['center', 'bottom']}),
    a11_2:  rst({fg: mopt['t11'].fg, anchor: ['start', 'top']}),
    a11_3:  rst({fg: mopt['t11'].fg, anchor: ['end', 'middle']}),
    a11_4:  ost({anchor: ['end', 'middle']}),
    a11_5:  ost({anchor: ['start', 'middle']}),
    a11_6:  ost({anchor: ['center', 'bottom']}),
    a11_7:  ost({anchor: ['center', 'top']}),
    a11_8:  ost({anchor: ['start', 'bottom']}),
    a11_9:  ost({anchor: ['end', 'bottom']})
  });
    // lines
  RLNS.map(function(line,i){
    var ftype = line[0], abbr = line[1], coords = line[2];
    var pts = DC.interpolateCoords(coords, true),
        path = ('M ' + pts).replace(/,/g, ' ');
    DC.append('path', {
      class: [i, ftype, abbr].join(),
      fill: mopt[ftype].bg || 'none', stroke: mopt[ftype].fg,
      'stroke-dasharray': mopt[ftype].dash,
      'stroke-linejoin': mopt[ftype].join,
      'stroke-linecap': mopt[ftype].cap,
      'stroke-width': mds(mopt[ftype].width), d: path
    });
  });
    // add stations
  RSTS.concat(MSTS).concat(RLBS).map(function(st){
    var ftype = st[0], abbr = st[1], coords = st[2][0] || st[4], label = st[3];
    var pts = DC.toPoints(coords, true);
    var tip = ftype.split('_')[0].slice(1),
        mlabel = label;
     // legend
    if(ftype[0] == 'a' && RLGN['t'+tip]) mlabel += ', ' + RLGN['t'+tip] + ' ('+ tip + ')';
    if(ftype[0] == 's' && MLGN['r'+tip]) mlabel += ', ' + MLGN['r'+tip] + ' ('+ tip + ')';
    var station = DC.append('circle', {
      id: ftype +'_'+ abbr, class: mlabel,
      cx: pts[0], cy: pts[1], r: mds(mopt[ftype].size),
      fill: mopt[ftype].bg, stroke: mopt[ftype].fg
    });
    if(!label) return;
    var a, dx = 10, dy = 0;
    if(a = mopt[ftype].anchor) {
      if(a[0] == 'start')    dx = 10;
      else if(a[0] == 'center') dx = -label.length*2;
      else if(a[0] == 'end') dx = -10;
      if(a[1] == 'top') dy = 15;
      else if(a[1] == 'middle') dy = 3;
      else if(a[1] == 'bottom') dy = -10;
    };
    var text = DC.append('text', {
      id: 'txt'+ ftype +'_'+ abbr,
      x: pts[0] + mds(dx), y: pts[1] + mds(dy), fill: mopt[ftype].labelcolor || 'black',
      'font-family': 'sans-serif', 'font-size': DC.root.getAttribute('width')/110, 'font-weight':'normal',
      'text-anchor': a ? a[0] : ''
    });
    text.appendChild(document.createTextNode(label));
    DC.extend(station, {
      onmousemove: function(ev){
        var scale = 3;
        var ratio = scale/(scale-1);
        var cx = this.getAttribute('cx')/ratio,
            cy = this.getAttribute('cy')/ratio;
         // find text by id
        var text = document.getElementById('txt'+this.getAttribute('id'));
        var ts = [], tsattr =[];
        if(text){
          ts.push( {target: text} );
          tsattr.push( {'font-size': DC.root.getAttribute('width')/80, 'font-weight':'bold'} );
        }
        DC.doMap([ev].concat(ts), [{ // highlight station + label
            fill: 'rgb(255,127,0)',
            transform: 'scale(' + scale + ') translate(' + -cx + ',' + -cy + ')'
          }].concat(tsattr)
        );
        DC.append(ev.target, 'title', {}).textContent = ev.target.getAttribute('class') ;
      }
    });    
  });
};

var DC = new dbCartaSvg({
  id: 'mcont',
  height: document.getElementById('mcont').offsetHeight,
  bg: 'rgb(246,251,255)',
  sbarpos: 'left',
  scalebg: 'rgba(100,200,100,0.2)'
});
DC.scaleCarta(0.7);
  //
draw();

</script>
</body>
</html>
